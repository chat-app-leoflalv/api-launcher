version: '3'

services:
  nats-server:
    image: nats:latest
    ports:
      - 8222:8222

  gateway:
    build:
      context: ./gateway
      dockerfile: dockerfile
    ports:
      - ${GATEWAY_PORT}:${GATEWAY_PORT}
    volumes:
      - ./gateway/src:/usr/src/app/src
    command: cargo watch -c -x run
    environment:
      - PORT=${GATEWAY_PORT}
